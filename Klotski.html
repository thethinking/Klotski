<!doctype html>
<html lang='en'>

<head>
    <title>Klotski Puzzle</title>
    <meta charset="utf-8">

    <style>
        body {
            padding: 30px;
            color: #fff;
            background: #458588;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        #bar {
            background: #073642;
            padding: 3px;
            margin: 3px 15px;
            line-height: 28px;
            width: 395px;
        }

        #bar span {
            display: inline-block;
        }

        span.button {
            cursor: pointer;
            padding: 0px 8px;
        }

        #bar span.button {
            background: #93a1a1;

        }

        #bar span.button:hover {
            background: #ebdbb2;
            color: #000;
        }

        #rLbl {
            width: 75px;
            margin-left: 6px;
        }

        #sLbl {
            width: 70px;
            margin: 0px 8px;
        }

        #board {
            margin: 2px 15px;
            background: #eee8d5;
        }

        #history {
            background: #073642;
            padding: 15px;
            margin: 2px 15px;
            width: 371px;
            line-height: 28px;
        }

        #history span.button {
            float: right;
            color: #000;
            background: #ccc;
        }

        #history span.button:hover {
            color: #fff;
            background: #780425;
        }

        #history ul {
            padding: 0;
        }

        #history ul li {
            list-style-type: none;
            margin: 3px;
        }
    </style>
</head>

<body>

    <div id='bar'>
        <span title='First' class='button' onclick='selectRound(Number.NEGATIVE_INFINITY)'>|&#9668;&#9668;</span>
        <span title='Prev' class='button' onclick='selectRound(-1)'>&#9668;&#9668;</span>
        <span id='rLbl'>ROUND: 001</span>
        <span title='Next' class='button' onclick='selectRound(1)'>&#9658;&#9658;</span>
        <span title='Last' class='button' onclick='selectRound(Number.POSITIVE_INFINITY)'>&#9658;&#9658;|</span>
        <div style='float:right;'>
            <span id='sLbl'>STEP: 0</span>
            <span id='rBtn' title="Reset" class='button' onclick='reset()'>RESET</span>
        </div>
    </div>

    <canvas id='board' width='401' height='501'></canvas>

    <div id='history'>
        <span>RECORD:</span><span class='button' style='float: right' onclick='clearStorage()'>Delete</span>
        <ul id='records'></ul>
        <span>CONTACT: chufazheng@126.com</span>
    </div>

    <script>
        'use strict';
        const UNIT = 100;
        const Board = document.getElementById('board');
        const RoundLabel = document.getElementById('rLbl');
        const StepLabel = document.getElementById('sLbl');
        const RecordList = document.getElementById('records');
        const Context = Board.getContext('2d');
        const BW = [0, 1, 1, 2, 2];
        const BH = [0, 1, 2, 1, 2];
        const DATA = [
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 2, 1, 1, 2, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1, 2, 1, 1, 2, 2, 0, 0, 2],
            [0, 4, 4, 0, 2, 4, 4, 2, 2, 2, 2, 2, 1, 2, 2, 1, 3, 3, 1, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 1, 1, 1, 2, 3, 3, 2, 2, 0, 0, 2],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 3, 3, 2, 2, 1, 1, 2, 2, 0, 0, 2],
            [2, 4, 4, 1, 2, 4, 4, 1, 2, 3, 3, 2, 2, 2, 0, 2, 1, 2, 0, 1],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 2, 2, 2, 2, 2, 2, 2, 0, 3, 3, 0],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 2, 2, 2, 1, 2, 2, 1, 0, 3, 3, 0],
            [2, 4, 4, 1, 2, 4, 4, 1, 2, 2, 2, 1, 2, 2, 2, 1, 0, 3, 3, 0],
            [2, 4, 4, 1, 2, 4, 4, 1, 2, 3, 3, 2, 2, 1, 2, 2, 0, 1, 2, 0],
            [2, 4, 4, 1, 2, 4, 4, 1, 2, 3, 3, 1, 2, 2, 2, 1, 0, 2, 2, 0],
            [1, 4, 4, 1, 1, 4, 4, 1, 0, 3, 3, 0, 2, 2, 2, 2, 2, 2, 2, 2],
            [2, 4, 4, 1, 2, 4, 4, 1, 3, 3, 1, 1, 2, 3, 3, 2, 2, 0, 0, 2],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 2, 0, 1, 1, 2, 0, 1, 3, 3, 3, 3],
            [2, 4, 4, 1, 2, 4, 4, 1, 2, 3, 3, 2, 2, 3, 3, 2, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 3, 3, 3, 3, 1, 2, 0, 1, 1, 2, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1, 1, 3, 3, 1, 0, 3, 3, 0],
            [1, 4, 4, 2, 1, 4, 4, 2, 2, 3, 3, 1, 2, 3, 3, 1, 0, 3, 3, 0],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1, 3, 3, 3, 3, 1, 0, 0, 1],
            [2, 4, 4, 1, 2, 4, 4, 1, 3, 3, 3, 3, 3, 3, 3, 3, 1, 0, 0, 1],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 0, 3, 3, 2, 0, 3, 3, 3, 3, 3, 3],
            [2, 4, 4, 1, 2, 4, 4, 1, 3, 3, 3, 3, 3, 3, 3, 3, 0, 3, 3, 0],
            [2, 4, 4, 1, 2, 4, 4, 2, 3, 3, 2, 2, 2, 1, 2, 1, 2, 0, 0, 1],
            [1, 4, 4, 1, 1, 4, 4, 1, 0, 3, 3, 0, 2, 2, 2, 2, 2, 2, 2, 2],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 1, 1, 2, 2, 3, 3, 2, 2, 0, 0, 2],
            [1, 4, 4, 2, 1, 4, 4, 2, 3, 3, 2, 2, 1, 1, 2, 2, 0, 3, 3, 0],
            [1, 4, 4, 2, 1, 4, 4, 2, 2, 2, 1, 1, 2, 2, 3, 3, 0, 3, 3, 0],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 3, 3, 2, 1, 3, 3, 1, 0, 3, 3, 0],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 2, 3, 3, 2, 2, 3, 3, 0, 3, 3, 0],
            [2, 4, 4, 1, 2, 4, 4, 1, 1, 3, 3, 1, 3, 3, 3, 3, 0, 3, 3, 0],
            [1, 4, 4, 1, 2, 4, 4, 1, 2, 1, 3, 3, 3, 3, 3, 3, 0, 3, 3, 0],
            [1, 4, 4, 2, 2, 4, 4, 2, 2, 2, 3, 3, 1, 2, 1, 2, 1, 0, 0, 2],
            [2, 3, 3, 2, 2, 1, 1, 2, 0, 4, 4, 0, 1, 4, 4, 1, 3, 3, 3, 3],
            [2, 1, 1, 2, 2, 4, 4, 2, 1, 4, 4, 2, 2, 3, 3, 2, 2, 0, 0, 1],
            [1, 1, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 1, 1],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 3, 3, 2, 2, 2, 2, 2, 0, 2, 2, 0],
            [3, 3, 3, 3, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 1, 2, 3, 3, 1, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 1, 1, 1, 1, 3, 3, 1, 1, 0, 0, 1],
            [4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 3, 3, 1, 3, 3, 1, 1, 0, 0, 1],
            [4, 4, 3, 3, 4, 4, 2, 1, 2, 2, 2, 1, 2, 2, 1, 1, 0, 3, 3, 0],
            [1, 2, 2, 2, 1, 2, 2, 2, 3, 3, 1, 1, 3, 3, 4, 4, 0, 0, 4, 4],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 3, 3, 3, 3, 1, 3, 3, 1, 1, 0, 0, 1],
            [3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 1, 0, 1, 2, 1, 0, 1, 2],
            [4, 4, 1, 2, 4, 4, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 1, 1],
            [4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 1, 1, 2, 2, 1, 1, 2, 2, 0, 0],
            [4, 4, 3, 3, 4, 4, 3, 3, 2, 2, 3, 3, 2, 2, 1, 1, 1, 0, 0, 1],
            [2, 2, 1, 1, 2, 2, 2, 1, 3, 3, 2, 1, 3, 3, 4, 4, 0, 0, 4, 4],
            [1, 1, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 0, 3, 3, 1, 0, 1, 3, 3],
            [1, 3, 3, 1, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1, 0, 3, 3, 0],
            [1, 3, 3, 1, 2, 4, 4, 2, 2, 4, 4, 2, 1, 0, 0, 1, 3, 3, 3, 3],
            [4, 4, 3, 3, 4, 4, 3, 3, 0, 0, 1, 1, 2, 2, 1, 2, 2, 2, 1, 2],
            [0, 2, 1, 1, 2, 2, 2, 1, 2, 1, 2, 0, 3, 3, 4, 4, 3, 3, 4, 4],
            [4, 4, 1, 1, 4, 4, 3, 3, 3, 3, 3, 3, 1, 3, 3, 0, 3, 3, 1, 0],
            [4, 4, 1, 2, 4, 4, 0, 1, 0, 2, 3, 3, 1, 2, 3, 3, 1, 1, 3, 3],
            [0, 2, 1, 2, 1, 2, 0, 2, 2, 1, 4, 4, 2, 1, 4, 4, 3, 3, 3, 3],
            [2, 2, 1, 1, 2, 2, 2, 2, 4, 4, 2, 2, 4, 4, 2, 1, 0, 1, 2, 0],
            [0, 4, 4, 2, 1, 4, 4, 2, 2, 3, 3, 2, 2, 2, 0, 2, 1, 2, 1, 1],
            [4, 4, 1, 1, 4, 4, 3, 3, 3, 3, 1, 0, 1, 2, 3, 3, 0, 2, 3, 3],
            [2, 2, 2, 1, 2, 2, 2, 1, 3, 3, 1, 1, 3, 3, 4, 4, 0, 0, 4, 4],
            [0, 2, 2, 2, 0, 2, 2, 2, 1, 1, 1, 1, 4, 4, 3, 3, 4, 4, 3, 3],
            [2, 2, 1, 2, 2, 2, 1, 2, 3, 3, 1, 1, 3, 3, 4, 4, 0, 0, 4, 4],
            [3, 3, 2, 1, 1, 1, 2, 2, 0, 4, 4, 2, 1, 4, 4, 2, 3, 3, 0, 2],
            [2, 1, 1, 0, 2, 2, 4, 4, 0, 2, 4, 4, 2, 1, 3, 3, 2, 3, 3, 1],
            [0, 1, 2, 1, 4, 4, 2, 2, 4, 4, 1, 2, 1, 3, 3, 2, 0, 3, 3, 2],
            [0, 1, 1, 1, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 1, 3, 3, 2, 0],
            [0, 4, 4, 1, 2, 4, 4, 1, 2, 1, 3, 3, 2, 1, 3, 3, 2, 0, 3, 3],
            [4, 4, 1, 1, 4, 4, 2, 1, 3, 3, 2, 1, 3, 3, 2, 0, 3, 3, 2, 0],
            [0, 4, 4, 1, 0, 4, 4, 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 1, 3, 3],
            [4, 4, 2, 2, 4, 4, 2, 2, 1, 1, 3, 3, 1, 1, 2, 2, 0, 0, 2, 2],
            [1, 3, 3, 1, 2, 3, 3, 2, 2, 4, 4, 2, 1, 4, 4, 1, 0, 3, 3, 0],
            [4, 4, 1, 2, 4, 4, 0, 2, 1, 0, 3, 3, 1, 2, 3, 3, 1, 2, 3, 3],
            [4, 4, 1, 1, 4, 4, 1, 2, 0, 0, 2, 2, 3, 3, 2, 2, 1, 3, 3, 2],
            [1, 4, 4, 2, 1, 4, 4, 2, 1, 3, 3, 2, 1, 3, 3, 2, 0, 3, 3, 0],
            [3, 3, 3, 3, 1, 4, 4, 1, 1, 4, 4, 1, 0, 3, 3, 0, 1, 1, 1, 1],
            [3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 2, 2, 0, 0, 2, 2, 1, 1, 1, 1],
            [2, 2, 1, 1, 2, 2, 1, 1, 2, 2, 3, 3, 2, 2, 4, 4, 0, 0, 4, 4],
            [1, 4, 4, 1, 2, 4, 4, 1, 2, 0, 0, 2, 1, 3, 3, 2, 3, 3, 3, 3],
            [0, 1, 1, 0, 4, 4, 1, 2, 4, 4, 2, 2, 3, 3, 2, 2, 1, 3, 3, 2],
            [1, 4, 4, 1, 0, 4, 4, 2, 2, 3, 3, 2, 2, 3, 3, 0, 1, 3, 3, 1],
            [1, 4, 4, 1, 0, 4, 4, 2, 1, 3, 3, 2, 0, 2, 3, 3, 1, 2, 3, 3],
            [2, 0, 4, 4, 2, 1, 4, 4, 3, 3, 2, 1, 3, 3, 2, 1, 0, 3, 3, 1],
            [1, 4, 4, 1, 2, 4, 4, 0, 2, 3, 3, 2, 0, 3, 3, 2, 1, 3, 3, 1],
            [4, 4, 2, 1, 4, 4, 2, 0, 1, 1, 3, 3, 2, 0, 3, 3, 2, 3, 3, 1],
            [4, 4, 1, 1, 4, 4, 1, 2, 3, 3, 2, 2, 0, 1, 2, 2, 0, 3, 3, 2],
            [2, 1, 1, 2, 2, 0, 1, 2, 2, 1, 3, 3, 2, 0, 3, 3, 3, 3, 3, 3],
            [2, 1, 4, 4, 2, 0, 4, 4, 3, 3, 1, 1, 0, 3, 3, 2, 1, 3, 3, 2],
            [4, 4, 0, 0, 4, 4, 1, 2, 1, 1, 1, 2, 3, 3, 2, 2, 3, 3, 2, 2],
            [1, 1, 1, 1, 0, 3, 3, 0, 2, 4, 4, 2, 2, 4, 4, 2, 3, 3, 3, 3],
            [0, 4, 4, 1, 1, 4, 4, 2, 3, 3, 0, 2, 2, 1, 3, 3, 2, 3, 3, 1],
            [4, 4, 0, 1, 4, 4, 1, 1, 2, 1, 3, 3, 2, 3, 3, 2, 3, 3, 0, 2],
            [1, 4, 4, 1, 0, 4, 4, 1, 2, 0, 3, 3, 2, 3, 3, 2, 3, 3, 1, 2],
            [0, 4, 4, 0, 2, 4, 4, 2, 2, 3, 3, 2, 3, 3, 3, 3, 1, 1, 1, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 3, 3, 0, 1, 1, 1, 3, 3, 3, 3, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 1, 3, 3, 1, 3, 3, 0, 3, 3, 0, 1],
            [4, 4, 2, 1, 4, 4, 2, 1, 2, 3, 3, 1, 2, 3, 3, 1, 0, 3, 3, 0],
            [1, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 1, 3, 3, 3, 3, 0, 3, 3, 0],
            [2, 0, 1, 2, 2, 4, 4, 2, 1, 4, 4, 0, 3, 3, 3, 3, 1, 1, 3, 3],
            [0, 4, 4, 0, 2, 4, 4, 1, 2, 3, 3, 1, 1, 3, 3, 2, 1, 3, 3, 2],
            [4, 4, 1, 0, 4, 4, 1, 1, 2, 1, 3, 3, 2, 3, 3, 0, 3, 3, 3, 3],
            [1, 1, 2, 2, 1, 1, 2, 2, 4, 4, 0, 2, 4, 4, 0, 2, 3, 3, 3, 3],
            [1, 2, 4, 4, 1, 2, 4, 4, 3, 3, 1, 2, 3, 3, 2, 2, 1, 0, 2, 0],
            [1, 4, 4, 2, 1, 4, 4, 2, 1, 3, 3, 2, 1, 0, 2, 2, 3, 3, 2, 0],
            [2, 1, 2, 2, 2, 0, 2, 2, 0, 4, 4, 1, 1, 4, 4, 1, 3, 3, 3, 3],
            [1, 2, 0, 1, 1, 2, 0, 1, 2, 4, 4, 2, 2, 4, 4, 2, 3, 3, 3, 3],
            [2, 2, 0, 2, 2, 2, 0, 2, 1, 4, 4, 1, 1, 4, 4, 1, 3, 3, 3, 3],
            [2, 1, 3, 3, 2, 4, 4, 0, 1, 4, 4, 1, 0, 3, 3, 1, 3, 3, 3, 3],
            [3, 3, 0, 2, 0, 4, 4, 2, 1, 4, 4, 1, 3, 3, 3, 3, 1, 3, 3, 1],
            [3, 3, 1, 1, 3, 3, 4, 4, 1, 2, 4, 4, 0, 2, 3, 3, 3, 3, 1, 0],
            [3, 3, 1, 1, 1, 2, 4, 4, 0, 2, 4, 4, 3, 3, 1, 0, 3, 3, 3, 3],
            [1, 4, 4, 1, 1, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 1, 1, 1, 2, 1, 1, 1, 1, 0, 0, 1],
            [1, 4, 4, 2, 1, 4, 4, 2, 1, 3, 3, 1, 1, 1, 1, 1, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 1, 1, 2, 2, 1, 1, 2, 1, 0, 0, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 1, 2, 1, 1, 1, 1, 0, 0, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3],
            [1, 0, 1, 2, 4, 4, 1, 2, 4, 4, 2, 2, 3, 3, 2, 2, 0, 1, 3, 3],
            [0, 3, 3, 0, 1, 3, 3, 1, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1],
            [1, 0, 0, 1, 3, 3, 3, 3, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1],
            [1, 4, 4, 2, 1, 4, 4, 2, 1, 1, 3, 3, 3, 3, 2, 2, 0, 0, 2, 2],
            [4, 4, 1, 1, 4, 4, 1, 1, 3, 3, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 1, 1, 3, 3, 3, 3, 1, 1, 1, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 1, 1, 1, 1, 3, 3, 3, 3],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 1, 1, 3, 3, 1, 1, 3, 3, 1, 1],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 3, 3, 2, 2, 3, 3, 2, 2, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 3, 3, 3, 3, 3, 3, 1, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 1, 1, 3, 3, 3, 3, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 1, 1, 3, 3, 1, 1, 3, 3, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 3, 3, 2, 1, 3, 3, 2, 1],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 1, 1, 3, 3, 1, 1, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
            [0, 0, 4, 4, 3, 3, 4, 4, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 3, 3, 2, 2, 1, 1, 2, 2, 3, 3],
            [0, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 3, 3, 2, 1, 3, 3, 2, 1],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3],
            [0, 4, 4, 0, 1, 4, 4, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 1, 1, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 3, 3, 2, 2, 3, 3, 2, 2, 1, 1],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 1, 1, 2, 2, 3, 3, 2, 2, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 3, 3, 3, 3, 1, 1, 3, 3, 1, 1],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 3, 3, 3, 3, 1, 1, 1, 1, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 2, 2, 1, 1, 2, 2, 3, 3, 3, 3, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 2, 2, 3, 3, 2, 2, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 1, 1, 1, 1, 3, 3, 3, 3, 1, 1, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 1, 1, 2, 2, 3, 3, 2, 2],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 3, 3],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3],
            [2, 4, 4, 0, 2, 4, 4, 0, 2, 2, 3, 3, 2, 2, 1, 1, 3, 3, 1, 1],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 2, 2, 1, 1, 2, 2, 3, 3],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 3, 3, 1, 1, 3, 3, 3, 3, 1, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 2, 2, 3, 3, 2, 2, 1, 1, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3, 3],
            [0, 0, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1],
            [0, 4, 4, 0, 1, 4, 4, 1, 3, 3, 1, 1, 1, 1, 3, 3, 1, 1, 3, 3],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 1, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2],
            [2, 4, 4, 0, 2, 4, 4, 0, 3, 3, 1, 1, 3, 3, 3, 3, 1, 1, 3, 3],
            [1, 3, 3, 2, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 0, 2, 0, 1, 3, 3],
            [0, 1, 3, 3, 4, 4, 0, 2, 4, 4, 2, 2, 1, 1, 2, 2, 1, 3, 3, 2],
            [4, 4, 1, 0, 4, 4, 1, 1, 2, 1, 3, 3, 2, 2, 3, 3, 0, 2, 3, 3],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 3, 3, 2, 2, 3, 3, 2, 0, 3, 3, 0],
            [1, 4, 4, 1, 1, 4, 4, 1, 1, 1, 1, 1, 3, 3, 3, 3, 0, 3, 3, 0],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 3, 3, 2, 3, 3, 3, 3, 0, 1, 1, 0],
            [4, 4, 0, 2, 4, 4, 1, 2, 3, 3, 2, 1, 2, 0, 2, 1, 2, 3, 3, 1],
            [4, 4, 0, 2, 4, 4, 0, 2, 2, 3, 3, 1, 2, 1, 2, 1, 3, 3, 2, 1],
            [2, 4, 4, 1, 2, 4, 4, 1, 2, 1, 2, 2, 2, 1, 2, 2, 0, 0, 3, 3],
            [2, 4, 4, 1, 2, 4, 4, 1, 0, 0, 3, 3, 2, 1, 2, 2, 2, 1, 2, 2],
            [4, 4, 1, 2, 4, 4, 1, 2, 0, 0, 3, 3, 1, 2, 2, 2, 1, 2, 2, 2],
            [4, 4, 1, 1, 4, 4, 3, 3, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1],
            [4, 4, 0, 1, 4, 4, 0, 1, 2, 2, 3, 3, 2, 2, 1, 2, 3, 3, 1, 2],
            [4, 4, 0, 1, 4, 4, 0, 1, 2, 1, 3, 3, 2, 1, 2, 2, 3, 3, 2, 2],
            [4, 4, 0, 1, 4, 4, 0, 1, 2, 1, 3, 3, 2, 3, 3, 2, 3, 3, 1, 2],
            [4, 4, 0, 1, 4, 4, 0, 1, 2, 1, 3, 3, 2, 3, 3, 2, 1, 3, 3, 2],
            [1, 2, 1, 1, 1, 2, 0, 0, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3],
            [1, 1, 4, 4, 3, 3, 4, 4, 2, 1, 3, 3, 2, 1, 3, 3, 0, 0, 3, 3],
            [3, 3, 4, 4, 2, 1, 4, 4, 2, 1, 3, 3, 0, 1, 3, 3, 0, 1, 3, 3],
            [2, 1, 3, 3, 2, 1, 1, 1, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 0, 0],
            [1, 1, 3, 3, 3, 3, 4, 4, 2, 1, 4, 4, 2, 1, 3, 3, 0, 0, 3, 3],
            [2, 2, 4, 4, 2, 2, 4, 4, 1, 0, 1, 0, 2, 3, 3, 2, 2, 1, 1, 2],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 1, 1, 0, 2, 3, 3, 2, 0, 1, 1, 2],
            [2, 2, 2, 2, 2, 2, 2, 2, 0, 4, 4, 0, 1, 4, 4, 1, 3, 3, 1, 1],
            [2, 0, 4, 4, 2, 2, 4, 4, 1, 2, 2, 0, 1, 1, 2, 2, 3, 3, 1, 2],
            [3, 3, 3, 3, 2, 2, 1, 1, 2, 2, 3, 3, 4, 4, 3, 3, 4, 4, 0, 0],
            [4, 4, 0, 0, 4, 4, 3, 3, 1, 1, 2, 2, 3, 3, 2, 2, 3, 3, 3, 3],
            [4, 4, 1, 1, 4, 4, 3, 3, 1, 1, 3, 3, 3, 3, 2, 2, 0, 0, 2, 2],
            [4, 4, 1, 1, 4, 4, 3, 3, 0, 3, 3, 1, 2, 3, 3, 2, 2, 0, 1, 2],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 1, 1, 2, 2, 1, 1, 2, 1, 0, 0, 1],
            [2, 1, 3, 3, 2, 4, 4, 1, 1, 4, 4, 2, 3, 3, 1, 2, 0, 3, 3, 0],
            [4, 4, 2, 2, 4, 4, 2, 2, 0, 1, 0, 1, 2, 2, 3, 3, 2, 2, 1, 1],
            [0, 4, 4, 2, 2, 4, 4, 2, 2, 2, 1, 1, 1, 2, 0, 0, 3, 3, 3, 3],
            [2, 4, 4, 1, 2, 4, 4, 2, 3, 3, 1, 2, 3, 3, 0, 0, 1, 1, 3, 3],
            [1, 1, 3, 3, 1, 2, 4, 4, 0, 2, 4, 4, 0, 1, 3, 3, 3, 3, 3, 3],
            [1, 4, 4, 1, 1, 4, 4, 1, 2, 0, 0, 1, 2, 1, 1, 2, 1, 1, 1, 2],
            [0, 2, 2, 2, 1, 2, 2, 2, 0, 1, 1, 1, 4, 4, 3, 3, 4, 4, 3, 3],
            [1, 1, 2, 0, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 2, 0, 3, 3, 3, 3],
            [4, 4, 0, 2, 4, 4, 2, 2, 0, 1, 2, 1, 3, 3, 1, 2, 3, 3, 1, 2],
            [1, 1, 1, 1, 1, 4, 4, 1, 1, 4, 4, 1, 1, 1, 1, 1, 0, 3, 3, 0],
            [2, 2, 1, 1, 2, 2, 3, 3, 2, 4, 4, 0, 2, 4, 4, 1, 0, 3, 3, 1],
            [1, 1, 0, 1, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 0, 2, 3, 3, 1, 2],
            [1, 1, 2, 0, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 2, 3, 3, 0, 1],
            [4, 4, 3, 3, 4, 4, 1, 1, 0, 1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 2],
            [1, 2, 2, 0, 1, 2, 2, 1, 4, 4, 2, 1, 4, 4, 2, 0, 3, 3, 3, 3],
            [2, 0, 4, 4, 2, 1, 4, 4, 3, 3, 1, 2, 3, 3, 1, 2, 0, 1, 3, 3],
            [2, 2, 2, 1, 2, 2, 2, 1, 4, 4, 3, 3, 4, 4, 0, 0, 3, 3, 1, 1],
            [3, 3, 1, 1, 4, 4, 0, 0, 4, 4, 3, 3, 2, 2, 2, 1, 2, 2, 2, 1],
            [4, 4, 2, 0, 4, 4, 2, 0, 1, 2, 3, 3, 2, 2, 1, 2, 2, 1, 1, 2],
            [2, 2, 1, 1, 2, 2, 4, 4, 1, 1, 4, 4, 2, 2, 3, 3, 2, 2, 0, 0],
            [2, 2, 0, 0, 2, 2, 3, 3, 1, 1, 4, 4, 2, 2, 4, 4, 2, 2, 1, 1],
            [0, 2, 2, 1, 2, 2, 2, 1, 2, 4, 4, 1, 2, 4, 4, 0, 2, 1, 3, 3],
            [4, 4, 1, 2, 4, 4, 2, 2, 2, 1, 2, 1, 2, 2, 3, 3, 0, 2, 1, 0],
            [1, 4, 4, 2, 2, 4, 4, 2, 2, 2, 2, 1, 0, 2, 2, 0, 1, 1, 3, 3],
            [2, 4, 4, 2, 2, 4, 4, 2, 3, 3, 3, 3, 0, 1, 1, 0, 3, 3, 1, 1],
            [4, 4, 1, 0, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [4, 4, 2, 2, 4, 4, 2, 2, 2, 1, 1, 0, 2, 1, 1, 0, 3, 3, 3, 3],
            [2, 2, 0, 2, 2, 2, 0, 2, 2, 2, 4, 4, 2, 2, 4, 4, 1, 1, 1, 1],
            [1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 4, 4, 0, 0, 4, 4, 3, 3],
            [3, 3, 3, 3, 0, 1, 1, 0, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1],
            [2, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 1, 2, 3, 3, 2, 0, 0, 1, 2],
            [0, 1, 1, 0, 2, 3, 3, 2, 2, 4, 4, 2, 1, 4, 4, 1, 3, 3, 3, 3],
            [1, 4, 4, 1, 2, 4, 4, 0, 2, 2, 3, 3, 2, 2, 1, 1, 2, 3, 3, 0],
            [0, 2, 1, 1, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 3, 3, 1, 0],
            [3, 3, 3, 3, 2, 1, 4, 4, 2, 1, 4, 4, 2, 1, 1, 1, 2, 0, 0, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 0, 0, 2, 2, 1, 1, 2, 2, 3, 3, 2],
            [2, 1, 3, 3, 2, 4, 4, 1, 2, 4, 4, 1, 2, 2, 0, 2, 0, 2, 1, 2],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 1, 2, 3, 3, 1, 2, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 1, 2, 3, 3, 1, 2, 0, 2, 2, 3, 3, 2, 2],
            [2, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 1, 1, 0, 0],
            [4, 4, 1, 2, 4, 4, 2, 2, 0, 1, 2, 1, 0, 3, 3, 2, 3, 3, 1, 2],
            [0, 4, 4, 0, 1, 4, 4, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 3, 3, 1],
            [4, 4, 0, 2, 4, 4, 1, 2, 1, 3, 3, 1, 1, 2, 2, 1, 1, 2, 2, 0],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1],
            [3, 3, 4, 4, 2, 1, 4, 4, 2, 2, 3, 3, 0, 2, 2, 1, 1, 0, 2, 1],
            [1, 0, 2, 2, 4, 4, 2, 2, 4, 4, 0, 2, 3, 3, 1, 2, 1, 1, 3, 3],
            [1, 0, 0, 2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 1, 2, 1, 1, 3, 3],
            [1, 4, 4, 0, 1, 4, 4, 0, 3, 3, 3, 3, 2, 2, 1, 1, 2, 2, 3, 3],
            [2, 3, 3, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 2, 1, 1, 0, 2, 1, 0],
            [0, 2, 1, 2, 2, 2, 0, 2, 2, 4, 4, 2, 2, 4, 4, 1, 2, 1, 3, 3],
            [2, 2, 1, 1, 2, 2, 4, 4, 1, 1, 4, 4, 1, 3, 3, 1, 1, 0, 0, 1],
            [2, 4, 4, 1, 2, 4, 4, 2, 3, 3, 1, 2, 2, 0, 1, 2, 2, 0, 1, 2],
            [2, 4, 4, 0, 2, 4, 4, 1, 3, 3, 2, 2, 2, 0, 2, 2, 2, 1, 1, 1],
            [0, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 2, 2, 1, 2, 1, 2, 1, 1],
            [3, 3, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 3, 3, 1, 1, 3, 3, 0, 0],
            [0, 1, 1, 0, 3, 3, 3, 3, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 1],
            [1, 1, 1, 1, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 2, 0, 0, 2, 2],
            [0, 0, 2, 2, 3, 3, 2, 2, 4, 4, 2, 2, 4, 4, 2, 2, 1, 1, 1, 1],
            [4, 4, 3, 3, 4, 4, 1, 2, 2, 1, 0, 2, 2, 1, 3, 3, 3, 3, 1, 0],
            [4, 4, 0, 0, 4, 4, 1, 2, 2, 1, 1, 2, 2, 1, 3, 3, 3, 3, 3, 3],
            [4, 4, 3, 3, 4, 4, 3, 3, 2, 1, 1, 2, 2, 3, 3, 2, 1, 0, 0, 1],
            [4, 4, 3, 3, 4, 4, 3, 3, 2, 1, 1, 2, 2, 0, 0, 2, 1, 3, 3, 1],
            [1, 1, 4, 4, 0, 0, 4, 4, 2, 1, 3, 3, 2, 3, 3, 2, 3, 3, 1, 2],
            [0, 4, 4, 0, 1, 4, 4, 1, 2, 3, 3, 2, 2, 3, 3, 2, 1, 3, 3, 1],
            [1, 3, 3, 2, 2, 4, 4, 2, 2, 4, 4, 2, 1, 3, 3, 2, 0, 1, 1, 0],
            [3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 1, 1, 1, 0, 0, 1, 3, 3],
            [3, 3, 4, 4, 3, 3, 4, 4, 3, 3, 1, 0, 1, 3, 3, 0, 1, 1, 3, 3],
            [3, 3, 4, 4, 3, 3, 4, 4, 1, 2, 1, 2, 1, 2, 1, 2, 0, 0, 3, 3],
            [4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 1, 1, 0, 2, 3, 3, 0, 2, 1, 1],
            [2, 4, 4, 2, 2, 4, 4, 2, 1, 2, 2, 1, 1, 2, 2, 1, 0, 3, 3, 0],
            [0, 1, 1, 0, 3, 3, 1, 1, 4, 4, 3, 3, 4, 4, 2, 2, 3, 3, 2, 2],
            [3, 3, 2, 2, 4, 4, 2, 2, 4, 4, 3, 3, 3, 3, 1, 1, 0, 1, 1, 0],
            [3, 3, 2, 2, 4, 4, 2, 2, 4, 4, 3, 3, 3, 3, 1, 1, 1, 1, 0, 0],
            [2, 1, 4, 4, 2, 1, 4, 4, 3, 3, 1, 1, 2, 3, 3, 2, 2, 0, 0, 2],
            [0, 0, 3, 3, 4, 4, 2, 1, 4, 4, 2, 2, 1, 2, 2, 2, 1, 2, 2, 1],
            [1, 2, 2, 1, 1, 2, 2, 2, 4, 4, 2, 2, 4, 4, 2, 1, 0, 0, 3, 3],
            [3, 3, 2, 0, 4, 4, 2, 0, 4, 4, 2, 1, 1, 2, 2, 2, 1, 2, 1, 2],
            [1, 1, 3, 3, 3, 3, 3, 3, 2, 4, 4, 0, 2, 4, 4, 0, 1, 1, 3, 3],
            [1, 2, 0, 0, 1, 2, 3, 3, 4, 4, 3, 3, 4, 4, 1, 1, 3, 3, 3, 3],
            [3, 3, 3, 3, 4, 4, 3, 3, 4, 4, 1, 1, 2, 0, 3, 3, 2, 1, 0, 1],
            [0, 2, 3, 3, 0, 2, 3, 3, 4, 4, 1, 1, 4, 4, 1, 1, 3, 3, 3, 3],
            [3, 3, 3, 3, 4, 4, 1, 1, 4, 4, 1, 1, 0, 2, 3, 3, 0, 2, 3, 3],
            [3, 3, 3, 3, 2, 0, 0, 1, 2, 4, 4, 1, 1, 4, 4, 1, 3, 3, 3, 3],
            [3, 3, 3, 3, 1, 4, 4, 1, 2, 4, 4, 1, 2, 0, 0, 1, 3, 3, 3, 3],
            [3, 3, 3, 3, 3, 3, 1, 1, 1, 4, 4, 1, 0, 4, 4, 0, 3, 3, 3, 3],
            [3, 3, 3, 3, 0, 4, 4, 0, 1, 4, 4, 1, 3, 3, 1, 1, 3, 3, 3, 3],
            [0, 4, 4, 0, 1, 4, 4, 2, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1],
            [4, 4, 1, 1, 4, 4, 3, 3, 3, 3, 2, 0, 3, 3, 2, 1, 1, 3, 3, 0],
            [1, 1, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 3, 3, 4, 4, 3, 3],
            [4, 4, 1, 0, 4, 4, 0, 2, 2, 3, 3, 2, 2, 3, 3, 1, 1, 1, 3, 3],
            [2, 2, 3, 3, 2, 2, 4, 4, 1, 2, 4, 4, 1, 2, 3, 3, 0, 1, 1, 0],
            [0, 1, 1, 0, 1, 2, 3, 3, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3],
            [4, 4, 2, 0, 4, 4, 2, 1, 1, 1, 3, 3, 2, 3, 3, 1, 2, 3, 3, 0],
            [4, 4, 2, 0, 4, 4, 2, 2, 1, 0, 1, 2, 2, 3, 3, 2, 2, 1, 1, 2],
            [2, 2, 4, 4, 2, 2, 4, 4, 1, 0, 1, 2, 2, 0, 1, 2, 2, 3, 3, 1],
            [4, 4, 3, 3, 4, 4, 2, 1, 1, 1, 2, 2, 2, 3, 3, 2, 2, 0, 0, 1],
            [2, 0, 0, 1, 2, 3, 3, 2, 1, 1, 2, 2, 4, 4, 2, 1, 4, 4, 3, 3],
            [4, 4, 3, 3, 4, 4, 2, 1, 3, 3, 2, 2, 1, 3, 3, 2, 1, 0, 0, 1],
            [1, 0, 0, 1, 1, 3, 3, 2, 3, 3, 2, 2, 4, 4, 2, 1, 4, 4, 3, 3],
            [4, 4, 3, 3, 4, 4, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2, 0, 2, 0, 2],
            [0, 2, 0, 2, 1, 2, 2, 2, 1, 1, 2, 2, 4, 4, 1, 2, 4, 4, 3, 3],
            [2, 1, 1, 1, 2, 2, 3, 3, 2, 2, 0, 1, 2, 0, 4, 4, 3, 3, 4, 4],
            [3, 3, 4, 4, 2, 0, 4, 4, 2, 2, 0, 1, 2, 2, 3, 3, 2, 1, 1, 1],
            [3, 3, 1, 1, 3, 3, 4, 4, 1, 1, 4, 4, 3, 3, 2, 2, 0, 0, 2, 2],
            [2, 2, 1, 1, 2, 2, 2, 2, 4, 4, 2, 2, 4, 4, 2, 1, 1, 0, 2, 0],
            [1, 1, 1, 2, 4, 4, 2, 2, 4, 4, 2, 2, 1, 3, 3, 2, 0, 0, 3, 3],
            [4, 4, 1, 2, 4, 4, 0, 2, 0, 2, 3, 3, 1, 2, 3, 3, 1, 1, 3, 3],
            [2, 2, 2, 2, 2, 2, 2, 2, 1, 4, 4, 1, 0, 4, 4, 0, 3, 3, 1, 1],
            [4, 4, 0, 2, 4, 4, 1, 2, 0, 1, 2, 1, 3, 3, 2, 2, 3, 3, 1, 2],
            [1, 4, 4, 1, 2, 4, 4, 2, 2, 2, 0, 2, 1, 2, 0, 1, 3, 3, 3, 3],
            [1, 1, 2, 0, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 2, 0, 3, 3, 3, 3],
            [1, 4, 4, 2, 1, 4, 4, 2, 2, 3, 3, 2, 2, 3, 3, 2, 0, 3, 3, 0],
            [0, 1, 2, 2, 4, 4, 2, 2, 4, 4, 0, 2, 2, 3, 3, 2, 2, 0, 3, 3],
            [0, 0, 2, 2, 3, 3, 2, 2, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4, 1, 1],
            [2, 0, 4, 4, 2, 2, 4, 4, 1, 2, 2, 1, 1, 1, 2, 2, 3, 3, 0, 2],
            [2, 4, 4, 2, 2, 4, 4, 2, 2, 3, 3, 2, 2, 3, 3, 2, 1, 0, 0, 1]
        ];


        var player, round, roundString, step, path, map, solved, target;

        function init() {
            Board.addEventListener('click', move);
            document.addEventListener('keydown', ArrowKeyHandle);
            player = null;
            round = getRound();
            showRecords();
            reset();
        }

        function reset() {
            if (player !== null) {
                stopPlayer();
            }
            target = [0, 0];
            solved = false;
            step = -1;
            updateStep();
            path = [];
            map = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]];
            roundString = 'ROUND: ' + ('000' + (parseInt(round) + 1)).slice(-3);
            RoundLabel.innerText = roundString;
            Context.clearRect(0, 0, 4 * UNIT, 5 * UNIT);
            Context.fillStyle = '#fb4934';
            placeBlocks();
        }

        function placeBlocks() {
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 4; col++) {
                    if (map[row][col] != 0) {
                        continue;
                    }
                    map[row][col] = DATA[round][row * 4 + col];
                    if (map[row][col] != 0) {
                        drawBlock(row, col, map[row][col]);
                    }
                    switch (map[row][col]) {
                        case 2:
                            map[row + 1][col] = 2;
                            break;
                        case 3:
                            map[row][col + 1] = 3;
                            break;
                        case 4:
                            map[row + 1][col + 1] = 4;
                            map[row + 1][col] = 4;
                            map[row][col + 1] = 4;
                    }
                }
            }
        }

        function drawBlock(row, col, bType) {
            Context.fillRect(col * UNIT + 1, row * UNIT + 1, BW[bType] * UNIT - 1, BH[bType] * UNIT - 1);
        }

        function clearBlock(row, col, bType) {
            Context.clearRect(col * UNIT + 1, row * UNIT + 1, BW[bType] * UNIT - 1, BH[bType] * UNIT - 1);
        }

        function getRound() {
            let round = JSON.parse(localStorage.getItem('round'));
            return round != null ? parseInt(round) : 0;
        }

        function selectRound(param) {
            round += param;
            if (round < 0) {
                round = 0;
            } else if (round >= DATA.length) {
                round = DATA.length - 1;
            }
            localStorage.setItem('round', round);
            reset();
        }

        function updateStep() {
            StepLabel.innerText = 'STEP: ' + (++step);
        }

        function logMove(row, col, dir) {
            path.push([row, col, dir]);
        }

        function formatDate(t) {
            let date = new Date(parseInt(t));
            return date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate() + ' ' + date.getHours() + ':' + date.getMinutes()
        }

        function showRecords() {
            let recorder = JSON.parse(localStorage.getItem('records'));
            if (recorder != null) {
                if (!Array.isArray(recorder))
                    recorder = [recorder];
                RecordList.innerHTML = '';
                recorder.sort(function (a, b) {
                    if (parseInt(a._r.slice(-3)) > parseInt(b._r.slice(-3)))
                        return 1;
                    else {
                        return -1;
                    }
                })
                for (let r of recorder) {
                    let round = parseInt((r._r).slice(-3)) - 1;
                    let msg = '[' + r._r + '][STEP: ' + r._s + '][' + formatDate(r._t) + ']';
                    msg += '<span class="button" onclick="StartPlayer(' + round + ')">[&#9658;]</span>'
                    let entry = document.createElement('LI')
                    entry.innerHTML = msg;
                    RecordList.appendChild(entry);
                }
            }
        }

        function clearStorage() {
            localStorage.clear();
            RecordList.innerHTML = '';
            reset();
        }

        function StartPlayer(r) {
            round = r;
            reset();
            Board.removeEventListener('click', move);
            document.removeEventListener('keydown', ArrowKeyHandle);
            let key = '_p' + r;
            let p = JSON.parse(localStorage.getItem(key));
            let t = 0;
            player = setInterval(function () {
                let tuple = p[t];
                switch (tuple[2]) {
                    case 0:
                        moveLeft(tuple[0], tuple[1]);
                        break;
                    case 1:
                        moveUp(tuple[0], tuple[1]);
                        break;
                    case 2:
                        moveRight(tuple[0], tuple[1]);
                        break;
                    case 3:
                        moveDown(tuple[0], tuple[1]);
                        break;
                }
                t++;
                if (t == p.length) {
                    stopPlayer();
                }
            }.bind(this), 300);
        }

        function stopPlayer() {
            clearInterval(player);
            Board.addEventListener('click', move);
            document.addEventListener('keydown', ArrowKeyHandle);
            player = null;
        }

        function move(event) {
            if (solved) return;
            let col = parseInt((event.clientX - Board.offsetLeft) / UNIT);
            let row = parseInt((event.clientY - Board.offsetTop) / UNIT);
            let t_row = target[0];
            let t_col = target[1];
            let t_type = map[t_row][t_col];
            let cellClicked = map[row][col];
            if (cellClicked == 0) {
                if (col < t_col && row >= t_row && row < t_row + BH[t_type]) {
                    moveLeft(t_row, t_col);
                } else if (col >= t_col + BW[t_type] && row >= t_row && row < t_row + BH[t_type]) {
                    moveRight(t_row, t_col);
                } else if (row < t_row && col >= t_col && col < t_col + BW[t_type]) {
                    moveUp(t_row, t_col);
                } else if (row >= t_row + BH[t_type] && col >= t_col && col < t_col + BW[t_type]) {
                    moveDown(t_row, t_col);
                }
                return;
            }
            target = findBlock(row, col, cellClicked);
        }

        function check() {
            if (map[3][1] == map[4][2] && map[4][2] == 4) {
                Context.fillStyle = '#780425';
                drawBlock(3, 1, 4);
                Context.fillStyle = '#fabd2f';
                Context.font = "16px 'Courier new'";
                Context.fillText('SOLVED!', 168, 400);
                solved = true;
                let recorder = JSON.parse(localStorage.getItem('records'));
                if (recorder !== null) {
                    if (!Array.isArray(recorder)) {
                        recorder = [recorder];
                    }
                    let find = false;
                    for (let i = 0; i < recorder.length; i++) {
                        if (recorder[i]._r == roundString) {
                            find = true;
                            if (recorder[i]._s > step) {
                                recorder[i]._s = step;
                                localStorage.setItem('records', JSON.stringify(recorder));
                            }
                        }
                    }
                    if (!find) {
                        recorder.push({ '_r': roundString, '_s': step, '_t': (new Date().getTime()) })
                        localStorage.setItem('records', JSON.stringify(recorder));
                    }
                } else {
                    localStorage.setItem('records', JSON.stringify({ '_r': roundString, '_s': step, '_t': (new Date().getTime()) }));
                }
                let key = '_p' + round;
                localStorage.setItem(key, JSON.stringify(path));
                showRecords();
            }
        }

        function findBlock(row, col, bType) {
            if (bType == 1) {
                return [row, col];
            } else if (bType == 2) {
                if (row == 0)
                    return [0, col];
                if (row == 4)
                    return [3, col];
                if (2 != map[row + 1][col])
                    return [row - 1, col];
                if (2 != map[row - 1][col])
                    return [row, col];
                if (row == 1)
                    return [0, col];
                if (row == 3)
                    return [3, col];
                if (map[0][col] == 2)
                    return [2, col];
                return [1, col];
            } else if (bType == 3) {
                if (col == 0)
                    return [row, 0];
                if (col == 3)
                    return [row, 2];
                if (3 != map[row][col - 1])
                    return [row, col];
                if (3 != map[row][col + 1])
                    return [row, col - 1];
                return [row, 2 * (col - 1)];
            } else if (bType == 4) {
                if (col > 0 && 4 == map[row][col - 1]) {
                    if (row > 0 && 4 == map[row - 1][col - 1]) {
                        return [row - 1, col - 1];
                    } else {
                        return [row, col - 1];
                    }
                } else {
                    if (row > 0 && 4 == map[row - 1][col]) {
                        return [row - 1, col];
                    } else {
                        return [row, col];
                    }
                }
            }
            return [-1, -1];
        }

        function moveLeft(row, col) {
            let bType = map[row][col];
            switch (bType) {
                case 1:
                    if (col <= 0 || map[row][col - 1] != 0) {
                        return;
                    }
                    map[row][col] = 0;
                    map[row][col - 1] = 1;
                    break;
                case 2:
                    if (col <= 0 || map[row][col - 1] != map[row + 1][col - 1] || map[row][col - 1] != 0) {
                        return;
                    }
                    map[row][col - 1] = map[row + 1][col - 1] = 2;
                    map[row][col] = map[row + 1][col] = 0;
                    break;
                case 3:
                    if (col <= 0 || map[row][col - 1] != 0) {
                        return;
                    }
                    map[row][col + 1] = 0;
                    map[row][col - 1] = 3;
                    break;
                case 4:
                    if (col <= 0 || map[row][col - 1] != map[row + 1][col - 1] || map[row][col - 1] != 0) {
                        return;
                    }
                    map[row][col - 1] = map[row + 1][col - 1] = 4;
                    map[row][col + 1] = map[row + 1][col + 1] = 0;
            }
            clearBlock(row, col, bType);
            drawBlock(row, col - 1, bType);
            target = [row, col - 1];
            updateStep();
            logMove(row, col, 0);
            if (bType == 4) {
                check();
            }
        }

        function moveUp(row, col) {
            let bType = map[row][col];
            switch (bType) {
                case 1:
                    if (row <= 0 || map[row - 1][col] != 0) {
                        return;
                    }
                    map[row][col] = 0;
                    map[row - 1][col] = 1;
                    break;
                case 2:
                    if (row <= 0 || map[row - 1][col] != 0) {
                        return;
                    }
                    map[row + 1][col] = 0;
                    map[row - 1][col] = 2;
                    break;
                case 3:
                    if (row <= 0 || map[row - 1][col] != map[row - 1][col + 1] || map[row - 1][col + 1] != 0) {
                        return;
                    }
                    map[row - 1][col] = map[row - 1][col + 1] = 3;
                    map[row][col] = map[row][col + 1] = 0;
                    break;
                case 4:
                    if (row <= 0 || map[row - 1][col] != map[row - 1][col + 1] || map[row - 1][col + 1] != 0) {
                        return;
                    }
                    map[row - 1][col] = map[row - 1][col + 1] = 4;
                    map[row + 1][col] = map[row + 1][col + 1] = 0;
            }
            clearBlock(row, col, bType);
            drawBlock(row - 1, col, bType);
            target = [row - 1, col];
            updateStep();
            logMove(row, col, 1);
        }

        function moveRight(row, col) {
            let bType = map[row][col];
            switch (bType) {
                case 1:
                    if (col >= 3 || map[row][col + 1] != 0) {
                        return;
                    }
                    map[row][col] = 0;
                    map[row][col + 1] = 1;
                    break;
                case 2:
                    if (col >= 3 || map[row][col + 1] != map[row + 1][col + 1] || map[row][col + 1] != 0) {
                        return;
                    }
                    map[row][col + 1] = map[row + 1][col + 1] = 2;
                    map[row][col] = map[row + 1][col] = 0;
                    break;
                case 3:
                    if (col >= 2 || map[row][col + 2] != 0) {
                        return;
                    }
                    map[row][col] = 0;
                    map[row][col + 2] = 3;
                    break;
                case 4:
                    if (col >= 2 || map[row][col + 2] != map[row + 1][col + 2] || map[row + 1][col + 2] != 0) {
                        return;
                    }
                    map[row][col + 2] = map[row + 1][col + 2] = 4;
                    map[row][col] = map[row + 1][col] = 0;
            }
            clearBlock(row, col, bType);
            drawBlock(row, col + 1, bType);
            target = [row, col + 1];
            updateStep();
            logMove(row, col, 2);
            if (bType == 4) {
                check();
            }
        }

        function moveDown(row, col) {
            let bType = map[row][col];
            switch (bType) {
                case 1:
                    if (row >= 4 || map[row + 1][col] != 0) {
                        return;
                    }
                    map[row][col] = 0;
                    map[row + 1][col] = 1;
                    break;
                case 2:
                    if (row >= 3 || map[row + 2][col] != 0) {
                        return;
                    }
                    map[row][col] = 0;
                    map[row + 2][col] = 2;
                    break;
                case 3:
                    if (row >= 4 || map[row + 1][col] != map[row + 1][col + 1] || map[row + 1][col + 1] != 0) {
                        return;
                    }
                    map[row + 1][col] = map[row + 1][col + 1] = 3;
                    map[row][col] = map[row][col + 1] = 0;
                    break;
                case 4:
                    if (row >= 3 || map[row + 2][col] != map[row + 2][col + 1] || map[row + 2][col + 1] != 0) {
                        return;
                    }
                    map[row + 2][col] = map[row + 2][col + 1] = 4;
                    map[row][col] = map[row][col + 1] = 0;
            }
            clearBlock(row, col, bType);
            drawBlock(row + 1, col, bType);
            target = [row + 1, col];
            updateStep();
            logMove(row, col, 3);
            if (bType == 4) {
                check();
            }
        }

        function ArrowKeyHandle(event) {
            event.preventDefault();
            if (solved) return;
            switch (event.keyCode) {
                case 37:
                case 65:
                    moveLeft(target[0], target[1]);
                    break;
                case 38:
                case 87:
                    moveUp(target[0], target[1]);
                    break;
                case 39:
                case 68:
                    moveRight(target[0], target[1]);
                    break;
                case 40:
                case 83:
                    moveDown(target[0], target[1]);
            }
        }

        init();
    </script>
</body>

</html>
